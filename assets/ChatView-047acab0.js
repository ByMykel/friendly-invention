import{g as $,s as C,u as B}from"./useUser-0e2b2fc4.js";import{r as p,f as b,d as g,o as n,c as r,a as u,u as m,g as w,h as k,b as T,v as I,j as _,k as L,T as j,e as v,p as S,l as V,_ as y,t as M,m as R,F as z,n as D,q as h,s as H}from"./index-8115cec7.js";const x=e=>new Promise(s=>setTimeout(s,e));function N(){const e=p([]),s=p(!1),o=async(a,t)=>{e.value.push({from:"user",type:"text",text:a}),t(),await i(a,t)},l=async a=>{s.value=!0,await $().then(async t=>{s.value=!1;for(const c of t)e.value.push({from:"bot",...c}),a(),await x(100)}).catch(t=>{s.value=!1,t.response.status===401&&(sessionStorage.removeItem("token"),b.push({name:"login"}))})},i=async(a,t)=>{s.value=!0,await C(a).then(async c=>{s.value=!1;for(const d of c)e.value.push({from:"bot",...d}),t(),await x(100)}).catch(c=>{s.value=!1,c.response.status===401&&(sessionStorage.removeItem("token"),b.push({name:"login"}))})};return{messages:e,isTyping:s,addMessage:o,getBotWelcomeMessage:l}}const E={class:"h-14 w-full max-w-3xl"},K={class:"flex items-center justify-between h-full"},U=u("div",{class:"flex items-center space-x-2"},[u("img",{class:"mx-auto h-8 w-auto",src:"https://www.verbio.com/wp-content/themes/verbio-theme/dist/images/logo.svg",alt:"Verbio Logo",loading:"lazy",decode:"async"})],-1),W={class:"flex items-center space-x-2"},F=g({__name:"ChatHeader",setup(e){const{handleLogout:s}=B();return(o,l)=>(n(),r("header",E,[u("div",K,[U,u("div",W,[u("button",{type:"button",class:"w-full rounded-md bg-verbio-main py-2 px-4 text-sm font-medium text-white hover:bg-verbio-mainDark focus:bg-verbio-mainDark focus:outline-none",onClick:l[0]||(l[0]=(...i)=>m(s)&&m(s)(...i)),onKeyup:l[1]||(l[1]=w((...i)=>m(s)&&m(s)(...i),["enter"]))}," Log out ",32)])])]))}}),q=e=>(S("data-v-2b32da42"),e=e(),V(),e),A={class:"w-full max-w-3xl h-20"},P={class:"relative rounded-md h-full py-2"},G={class:"absolute inset-y-0 right-0 flex items-center pr-2"},J=q(()=>u("svg",{class:"w-6 h-6 text-verbio-main",fill:"none",stroke:"currentColor","stroke-width":"1.5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})],-1)),O=[J],Q=g({__name:"ChatMessageInput",emits:["submit"],setup(e,{emit:s}){const o=p(""),l=p();k(()=>{var a;(a=l.value)==null||a.focus()});const i=()=>{o.value.trim()!==""&&(s("submit",o.value),o.value="")};return(a,t)=>(n(),r("div",A,[u("div",P,[T(u("input",{ref_key:"inputRef",ref:l,"onUpdate:modelValue":t[0]||(t[0]=c=>o.value=c),type:"text",name:"message",class:"block w-full rounded-md border-gray-400 pl-3 pr-12 border-2 shadow-sm focus:border-verbio-main focus:ring-verbio-main sm:text-sm h-full focus:outline-none",placeholder:"Type your message here",onKeyup:t[1]||(t[1]=w(c=>i(),["enter"]))},null,544),[[I,o.value]]),u("div",G,[_(j,{name:"send-button"},{default:L(()=>[o.value.length>0?(n(),r("button",{key:0,type:"button",name:"send-message",class:"bg-gray-200 hover:bg-gray-300 focus:bg-gray-300 p-2 rounded-full",onClick:t[2]||(t[2]=c=>i())},O)):v("",!0)]),_:1})])])]))}});const X=y(Q,[["__scopeId","data-v-2b32da42"]]),Y={class:"message-bot bg-verbio-main p-2 w-60 rounded-md text-white text-sm break-all"},Z={key:0},ee=["src"],se=g({__name:"MessageBot",props:{message:null},setup(e){return(s,o)=>(n(),r("div",Y,[e.message.type==="text"?(n(),r("p",Z,M(e.message.text),1)):(n(),r("img",{key:1,src:e.message.url,alt:"bot image",class:"w-full rounded-md"},null,8,ee))]))}}),te={class:"message-user bg-gray-400 p-2 w-60 rounded-md text-white text-sm break-all"},ae={key:0},oe=g({__name:"MessageUser",props:{message:null},setup(e){return(s,o)=>(n(),r("div",te,[e.message.type==="text"?(n(),r("p",ae,M(e.message.text),1)):v("",!0)]))}}),ne={},re={class:"animate-pulse absolute bottom-2 w-full flex justify-center"},le=R('<div class="message-bot bg-verbio-secondaryDark/70 w-auto p-2 py-0.5 rounded-full text-white text-sm break-all flex items-center gap-1"><span><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-robot" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M7 7h10a2 2 0 0 1 2 2v1l1 1v3l-1 1v3a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-3l-1 -1v-3l1 -1v-1a2 2 0 0 1 2 -2z"></path><path d="M10 16h4"></path><circle cx="8.5" cy="11.5" r=".5" fill="currentColor"></circle><circle cx="15.5" cy="11.5" r=".5" fill="currentColor"></circle><path d="M9 7l-1 -4"></path><path d="M15 7l1 -4"></path></svg></span><p>bot is typing...</p></div>',1),ie=[le];function ce(e,s){return n(),r("div",re,ie)}const ue=y(ne,[["render",ce]]),de={class:"w-full max-w-3xl bg-gray-300 overflow-y-hidden h-full rounded-md relative"},me=g({__name:"ChatMessageList",props:{messages:null,isTyping:{type:Boolean}},setup(e,{expose:s}){const o=p(null);return s({messagesRef:o}),(l,i)=>(n(),r("div",de,[u("ul",{ref_key:"messagesRef",ref:o,class:"overflow-y-scroll h-full space-y-2 bg-[url('/patterns/graph-paper.svg')] flex flex-col p-2"},[(n(!0),r(z,null,D(e.messages,(a,t)=>(n(),r("li",{key:`mesage-${t}`,class:H([a.from==="user"?"flex justify-end":"flex justify-start"])},[a.from==="user"?(n(),h(oe,{key:0,message:a},null,8,["message"])):(n(),h(se,{key:1,message:a},null,8,["message"]))],2))),128))],512),e.isTyping?(n(),h(ue,{key:0})):v("",!0)]))}});const pe=y(me,[["__scopeId","data-v-5f94b8bb"]]),ge={class:"flex h-screen items-center flex-col justify-center px-4 space-y-2"},he=g({__name:"ChatView",setup(e){const{messages:s,isTyping:o,addMessage:l,getBotWelcomeMessage:i}=N(),a=p(),t=()=>{var f;const d=(f=a==null?void 0:a.value)==null?void 0:f.messagesRef;d instanceof HTMLElement&&d.scrollTo({top:d.scrollHeight-10,behavior:"smooth"})},c=async d=>{await l(d,t),setTimeout(()=>{t()},200)};return k(async()=>{await i(t)}),(d,f)=>(n(),r("main",ge,[_(F),_(pe,{ref_key:"messageList",ref:a,messages:m(s),"is-typing":m(o)},null,8,["messages","is-typing"]),_(X,{onSubmit:c})]))}});export{he as default};
